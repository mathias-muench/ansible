---
# vi:ai:et:sw=2:ts=2

- hosts: localhost
  connection: local
  module_defaults:
    copy:
      backup: True
  roles:
    - name: proxy
    - name: cntlm
    - name: cloudflared-proxy-dns
    - name: bosch__azure-cli
  tasks:
    - slurp:
        src: /usr/lib/python3.7/site-packages/botocore/cacert.pem
      register: _cacert

    - become: True
      file:
        state: directory
        path: /usr/local/lib/python3.7/site-packages/botocore/

    - become: True
      copy:
        dest: /usr/local/lib/python3.7/site-packages/botocore/cacert.pem
        content: |
          {{ _cacert['content'] | b64decode }}
          {{ lookup('file', 'BOSCH-CA_DE.pem') }}

